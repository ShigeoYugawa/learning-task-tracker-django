# Learning Task Tracker (Django版)

このリポジトリは、**学習タスク管理アプリのPoC（概念実証）としてDjangoで開発したテンプレートベースのWebアプリケーション**です。

現在はDjangoでの学習を再開しており、基礎の理解を深めながら機能拡張を進めています。

---

## 🧭 Django版の位置づけ

- DjangoのMVC構成やCRUD処理の理解を深めることを目的に構築した学習用PoCです。  
- 現在のビュー構成は、**関数ベースビュー（FBV）を採用**しています。  
  → 初期実装ではクラスベースビュー（CBV）を利用していましたが、**PoC段階でのシンプルな構造と可読性の優先**を考慮し、FBVへリファクタリングしました。  
- 認証モデルにはDjangoの `AbstractUser` を継承した **カスタムユーザーモデル（CustomUser）を導入**。  
  → `CustomUser` は **Role（権限）情報を紐付け可能**にしており、管理画面でチェックボックスによる割り当ても可能です。  
  → `settings.AUTH_USER_MODEL` 経由で全体のユーザー参照を抽象化し、拡張性に配慮した設計です。  
- 認証はメールアドレスをユーザー名として扱うカスタム認証フォーム（`CustomLoginForm`）を導入し、  
  メールアドレス＋パスワードによるログインが可能な状態になっています。  
- 将来的にはFastAPI版などモダンなAPI分離構成への展開も視野に入れていますが、まずはDjango版で基礎固めを優先しています。

---

## 🗂 テンプレート構成について

現在、Djangoアプリのテンプレートは各アプリの `templates` ディレクトリ内で、  
さらにアプリ名をサブディレクトリとして分ける形（例：`apps/learning_content/templates/learning_content/`）で管理しています。  

この構成によりテンプレートの命名衝突を避け、Djangoのテンプレートローダーの標準的な慣習に沿った運用を行っています。  
ビューからのテンプレート指定時には、`learning_content/material_list.html` のようにアプリ名を含めたパスで指定しています。  

---

## 🧩 画面遷移とテンプレートの参照

教材（Material）や学習項目（MaterialNode）の一覧・詳細画面は、  
各テンプレートをサブディレクトリに分けて整理し、  
関数ベースビューから該当テンプレートを参照する形をとっています。  

- **Material / MaterialNode は親子関係で管理可能**  
- **ユーザー画面ではBootstrapアコーディオンで階層表示**（進捗記録や編集リンクも表示）  
- これによりPoC段階でも構造が分かりやすく、今後の拡張やFastAPIなど別構成への展開もスムーズに進められます。

---

## 🔑 認証方式の柔軟化について

- `settings.py` の `AUTH_METHOD` 設定により、ログイン認証の方法を切り替え可能です。  
  設定値は以下のいずれかを指定します：  
  - `'email'`（デフォルト）: メールアドレスでのログイン認証  
  - `'username'`: ユーザー名（ニックネーム）でのログイン認証  
  - `'both'`: メールアドレスまたはユーザー名のいずれかでログイン認証  
- `apps.accounts.backends.FlexibleAuthBackend` をカスタム認証バックエンドとして導入し、上記切り替え機能を実現しています。  
- ログインフォーム（`CustomLoginForm`）は認証方式に応じて入力欄のラベルやプレースホルダを動的に変更し、ユーザーにわかりやすいUIを提供します。  
- PoC段階での認証の柔軟性を高めるとともに、将来的な認証方式の拡張を容易にする設計となっています。  

---

## ✅ 現在の実装済み機能

- 学習タスク（Material / MaterialNode）の一覧表示、登録、編集、削除（CRUD）  
- MaterialNode を階層構造で管理（親子関係対応）  
- ユーザー画面でのアコーディオン表示による視認性向上  
- Djangoテンプレートを用いた基本的な画面表示  
- Bootstrap によるUI調整  
- 日本語化対応（画面表示・管理画面）  
- SQLiteによるシンプルなデータ永続化  
- Django管理画面の日本語カスタマイズ（モデル名・フィールド名・アプリ名）  
- CustomUser モデルと Role 連携、管理画面でのチェックボックス割り当て対応  
- ログイン済ユーザーに対する画面制御（@login_required）  
- メールアドレス＋パスワードによるログイン  
- レッスン単位での学習進捗（Progress）登録機能  
- 教材・レッスン・進捗画面間の遷移・連携が自然なUI設計

---

## 📐 設計見直しと再構築ブランチについて

現在の `main` ブランチでは、Djangoによる学習タスク管理アプリのPoCとして、  
教材（Material）・学習項目（MaterialNode）・進捗（Progress）を中心とした基本構成を採用しています。

- ブランチ名：`feature/refactor-material-node`  
- 設計変更の概要：
  - MaterialNode を自己参照の階層構造として表現  
  - 章・セクション・小項目などを柔軟に管理可能  
  - PoCの開発効率・メンテナンス性を考慮し、管理画面の複雑な絞り込みやJS制御は廃止  
  - ユーザー画面での Material / MaterialNode 登録・編集に注力

---

## 🔄 設計方針の見直しについて（フォーム統合・画面表示）

- フォームの統合・表示ロジックのシンプル化により、PoC段階での実装効率と可読性を向上  
- ユーザー認証フォーム、教材・学習項目フォームともに動的条件分岐を最小化  
- 将来的な再分離や拡張も容易な構成を維持

---

## 🛠 今後の開発予定（Django版）

- Djangoフォーム（ModelForm）による入力処理の強化  
- 教材モデルに対して進捗管理用の章・段階・マイルストーン等を追加検討  
- ユーザー登録・ログイン認証機能の拡張（外部認証連携・再設定機能など）  
- テストコード整備とCI/CDパイプライン構築  
- 必要に応じてREST API化やフロントエンド分離構成の検討  
- MaterialNode のネストツリー構造はシンプル管理に戻し、ユーザー画面での登録・編集機能を段階的に拡張  

---

## 📚 開発環境

- Python 3.12.3  
- Django 5.2.4  
- SQLite（開発用DB）  

---

## 📝 補足・所感

- Python と Django の再学習を目的に、PoCとして最小限の機能に絞りつつ、管理画面の拡張性や画面UIの改善を実施  
- CustomUser と Role の連携により、ユーザー認証基盤の将来的な拡張性を確保  
- フォーム構成・教材・MaterialNode 表示のシンプル化により、開発フェーズに応じた最適化を実施

---

## 📎 関連プロジェクト

- 🚀 [learning-task-tracker-fastapi](https://github.com/ShigeoYugawa/learning-task-tracker-fastapi) — API分離構成を目指すFastAPI版
