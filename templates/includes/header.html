<!-- templates/includes/header.html -->
<nav class="navbar navbar-expand-lg navbar-light bg-light">
  <div class="container-fluid">
    <a class="navbar-brand" href="/">学習タスク管理アプリ</a>
    <div class="collapse navbar-collapse">
      <ul class="navbar-nav ms-auto align-items-center">

        {% if user.is_authenticated %}
          
          <!-- 教材追加ボタン -->
          <li class="nav-item me-3">
            <a class="nav-link" href="{% url 'learning_content:material_create' %}">教材追加</a>
          </li>

          <!-- ノード追加ボタン（material があるとき） -->
          {% if material|default_if_none:'' %}
            <li class="nav-item me-3">
              <a class="nav-link" href="{% url 'learning_content:material_node_create' material.id %}">ノード追加</a>
            </li>
          {% endif %}

          <!-- 進捗記録ボタン（node があるとき） -->
          {% if node|default_if_none:'' %}
            <li class="nav-item me-3">
              <a href="{% url 'learning_content:progress_create' node.pk %}" class="btn btn-outline-success btn-sm">
                進捗を記録
              </a>
            </li>
          {% else %}
            <li class="nav-item me-3">
              <span class="nav-link text-muted">進捗を記録できません</span>
            </li>
          {% endif %}

          <!-- 挨拶 -->
          <li class="nav-item me-3">
            <span class="nav-link disabled">こんにちは、{{ user.username }} さん</span>
          </li>

          <!-- ログアウト -->
          <li class="nav-item">
            <form method="post" action="{% url 'logout' %}" class="d-inline">
              {% csrf_token %}
              <button
                type="submit"
                class="btn btn-link nav-link p-0 text-decoration-none"
                style="line-height: 1.5; padding-top: 8px;"
              >
                ログアウト
              </button>
            </form>
          </li>

        {% else %}
          <!-- 未ログイン時：ログイン・サインアップ -->
          <li class="nav-item me-3">
            <a class="nav-link" href="{% url 'login' %}">ログイン</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="{% url 'signup' %}">サインアップ</a>
          </li>
        {% endif %}

      </ul>
    </div>
  </div>
</nav>

